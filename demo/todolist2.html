<html>
<body>
<style>
  label, input, button {display:block;}
</style>

<p>A simple todo list inspired by the corresponding
  <a href="https://reactjs.org/">React</a> example.</p>

<h3>TODO</h3>

<div id="todos-example"></div>

<script src="../src/notemplate.js"></script>
<script type="text/javascript">

  registerElementHelpers();

  var state = {
    text: "",
    items: []
  };

  function todoList(items) {
    return ul(items.map(item =>
      li({key: item.id}, item.text)));
  }

  function handleSubmit(event) {
    event.preventDefault();
    const newItem = {
      text: state.text,
      id: Date.now()
    };
    state.items.push(newItem);
    render();
  }

  function render() {
    document.getElementById("todos-example").replaceWith(
      div({id: "todos-example"},
        todoList(state.items),
        form({submit: handleSubmit},
          label("What needs to be done?", {htmlFor: "new-todo"}),
          input({
            id: "new-todo",
            change: e => state.text = e.target.value}),
          button("Add #", this.state.items.length + 1))));
  }

  render();
</script>
</body>
</html>
